<div class="page-proveedores">
    <header class="page-header">
        <h1>Gestión de Proveedores</h1>
        <button class="btn btn-primary" (click)="abrirModal()">+ Nuevo Proveedor</button>
    </header>

    <div class="card">
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>RUC</th>
                        <th>Teléfono</th>
                        <th>Productos</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let p of proveedores">
                        <td>
                            <strong>{{ p.provnombre }}</strong>
                        </td>
                        <td>{{ p.provruc || '-' }}</td>
                        <td>{{ p.provtelefono || '-' }}</td>
                        <td>
                            <span class="badge badge-info">{{ p.total_productos || 0 }}</span>
                        </td>
                        <td class="actions">
                            <button class="btn-sm btn-secondary" (click)="abrirModal(p)" title="Editar">Editar</button>
                            <button class="btn-sm btn-danger" (click)="eliminar(p.provid)"
                                title="Eliminar">Eliminar</button>
                        </td>
                    </tr>
                    <tr *ngIf="proveedores.length === 0">
                        <td colspan="5" class="text-center">No hay proveedores registrados</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal-backdrop" *ngIf="modalOpen">
        <div class="modal" (click)="$event.stopPropagation()">
            <div class="modal-header">
                <h3>{{ modoEdicion ? 'Editar Proveedor' : 'Nuevo Proveedor' }}</h3>
                <button class="modal-close" (click)="cerrarModal()">&times;</button>
            </div>
            <form (ngSubmit)="guardar()">
                <div class="modal-body">
                    <div class="form-group">
                        <label>Nombre Comercial *</label>
                        <input type="text" [(ngModel)]="proveedorActual.nombre" name="nombre" class="form-control"
                            required placeholder="Ej. Distribuidora Central">
                    </div>
                    <div class="form-group">
                        <label>RUC</label>
                        <input type="text" [(ngModel)]="proveedorActual.ruc" name="ruc" class="form-control"
                            placeholder="Ej. 1712345678001">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Teléfono</label>
                            <input type="text" [(ngModel)]="proveedorActual.telefono" name="telefono"
                                class="form-control">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Dirección</label>
                        <textarea [(ngModel)]="proveedorActual.direccion" name="direccion" class="form-control"
                            rows="2"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" (click)="cerrarModal()">Cancelar</button>
                    <button type="submit" class="btn btn-success" [disabled]="loading">
                        {{ loading ? 'Guardando...' : 'Guardar' }}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>